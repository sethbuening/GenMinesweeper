import math, minesweeper1
WIDTH = 14
HEIGHT = 14
BOMBS = 40

# Initialize AI constants
NEURONS = [WIDTH*HEIGHT, math.floor(WIDTH*HEIGHT/4), math.floor(WIDTH*HEIGHT/16), math.floor(WIDTH*HEIGHT/4), WIDTH*HEIGHT] # Manually set NEURONS to be the number of neurons in each layer of a single network
WEIGHTS = 0
BIASES = 0
for i in range(len(NEURONS)-1):
    WEIGHTS += NEURONS[i]*NEURONS[i+1]
for i in range(1, len(NEURONS)):
    BIASES += NEURONS[i]
PARAMETERS = WEIGHTS+BIASES

individual = [-0.42810117492695476, 0.27555896338777863, 0.08342626398420055, -0.4684781829584874, 0.09825496026723657, -0.29191487132207494, -0.11866132872565249, 0.19716614307217484, 0.044692040512317455, 0.45040481557100237, 0.36744956840344944, 0.20801970202067943, 0.29268542417762256, 0.13314299953964281, -0.29088417604686634, 0.17217145848624293, -0.08322355187815011, -0.3031095613211493, 0.5262318568653723, 0.11568735495148219, 0.21030516919961173, 0.2039238490273172, -0.49569311940732996, 0.4026996095476253, 0.40035166152389245, 0.485663375810668, -0.2266186617036976, -0.12092794948687269, 0.3868983278416003, 0.15711079579459553, 0.4704284168908116, 0.006779259457486253, -0.2723767518835184, -0.35778977176290827, -0.4375924056070604, 0.29505066801405666, -0.1479572348036755, 0.3859745487547527, -0.46934218609673917, -0.18008732746427125, -0.25938113677208596, -0.42346674412053364, -0.012029214700510035, 0.07576705050820887, -0.09087911263886561, 0.3914576985631039, -0.3371288363234639, 0.38379385899379104, 0.23415856047196282, -0.08228856738152135, -0.2097419126762402, 0.34652496653877485, 0.4254063782728833, 0.38386325904055185, -0.1532536940002921, 0.4538751853664378, 0.1272777376676799, 0.4949384416363972, 0.04401277289012684, 0.30074410245849736, -0.3175215256073266, -0.4655923165687679, 0.323470412513992, -0.3776695972297501, -0.17403276278490754, -0.44984789073392295, -0.3227106076069266, 0.21406334499135293, -0.38323686593500694, 0.3946935180633117, -0.14348942343791615, 0.08070216136553887, 0.16771431142851645, -0.03312693354460139, -0.3197041272240173, 0.0774748449078424, 0.2074248310073986, 0.00724893622892131, 0.004917231705225511, -0.4253441358232788, 0.022048869877104874, -0.2820447111620096, -0.14501348572928788, 0.46031447882177623, 0.4509260161633294, -0.14600861032093382, -0.06349799104248188, -0.2915790455571734, 0.1615335178804624, -0.48775510149164414, 0.10653607296340051, 0.3135982747794359, -0.002167474303316097, -0.21846741254403046, 0.36216566375190484, -0.17467313068077228, -0.3346638527290624, -0.14640279163177478, 0.14507405122258898, 0.0742843599737576, -0.482715700176714, 0.3520550874059363, 0.5871863647989807, 0.68316194162071, -0.36888432264268933, 0.3808567696046805, -0.356653456471396, -0.2304744401018729, -0.1173279685986921, -0.32346666599342067, 0.19241566929892218, 0.06750506961355829, -0.3982167690176651, 0.48624477744393013, -0.3116292675133261, 0.058585217175803006, -0.06984182840257569, -0.48662365685398623, -0.09489719091221205, -0.43156429107681127, 0.011168949823471719, -0.023103234695857844, 0.17148287511303742, -0.2569843130502344, 0.028808272201445773, 0.15997321089194805, 0.24544906218506102, -0.6777412024688779, -0.4048141224286087, -0.2645040489749545, -0.4141722437070522, 0.23318283573768184, 0.4500945608531679, 0.2549107781368325, 0.12479630098281336, -0.12482929384141461, 0.18289117015529377, -0.39588013421146195, -0.45371398683160014, 0.33484886450470497, 0.16776926158367292, -0.033609893234605726, 0.08132521082405753, -0.47053710245180436, 0.14052528646041418, -0.4941145212137342, 0.10086367446362221]
weights = [individual[i] for i in range(WEIGHTS)] #torch.randn(272, dtype=torch.float32)
biases = [individual[i] for i in range(WEIGHTS, PARAMETERS)] # torch.randn(26, dtype=torch.float32)

minesweeper1.run(WIDTH, HEIGHT, BOMBS, weights, biases, NEURONS, test=True)